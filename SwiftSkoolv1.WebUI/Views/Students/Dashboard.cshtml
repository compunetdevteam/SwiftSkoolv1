 @using HopeAcademySMS.Models.Charts 
@model HopeAcademySMS.ViewModel.StudentDashboardVm
@{
    ViewBag.Title = "Dashboard";
}



<h2>Dashboard</h2>

@{
    var barModel = new List<DataPoint>();
    //Html.RenderAction("Area", "ChartTypes", new {model = ViewBag.MyModel});
}


<div class="section-body">

    <div class="row">

        <!-- BEGIN ALERT - REVENUE -->
        <div class="col-md-3 col-sm-6">
            <div class="card">
                <div class="card-body no-padding">
                    <div class="alert alert-callout alert-info no-margin">
                        @if (Model.FormTeacher == null)
                        {
                            <span class="text-xl">No Form Teacher Yet</span>
                            <br/>
                            <span class="opacity-50">Form Teacher</span>
                        }
                        else
                        {
                            <strong class="text-xl">@Model.FormTeacher</strong><br />
                            <span class="opacity-50">Form Teacher</span>
                        }
                        
                        @*<div class="stick-bottom-left-right">
                            <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                        </div>*@
                    </div>
                </div><!--end .card-body -->
            </div><!--end .card -->
        </div><!--end .col -->
        <!-- END ALERT - REVENUE -->
        <!-- BEGIN ALERT - VISITS -->
        <div class="col-md-3 col-sm-6">
            <div class="card">
                <div class="card-body no-padding">
                    <div class="alert alert-callout alert-warning no-margin">

                        <strong class="text-sm">@Model.Session</strong><br/>
                        <span class="opacity-50">Current Session</span>
                        <hr/>
                        <strong class="text-sm">@Model.Term</strong><br />
                        <span class="opacity-50">Current Term</span>
                        <div class="stick-bottom-right">
                            <div class="height-1 sparkline-visits" data-bar-color="#e5e6e6"></div>
                        </div>
                    </div>
                </div><!--end .card-body -->
            </div><!--end .card -->
        </div><!--end .col -->
        <!-- END ALERT - VISITS -->
        <!-- BEGIN ALERT - BOUNCE RATES -->
        <div class="col-md-3 col-sm-6">
            <div class="card">
                <div class="card-body no-padding">
                    <div class="alert alert-callout alert-danger no-margin">

                        <strong class="text-xl">@Model.Term</strong><br />
                        <span class="opacity-50">Current Term</span>
                        <div class="stick-bottom-left-right">
                            <div class="progress progress-hairline no-margin">
                                <div class="progress-bar progress-bar-danger" style="width:43%"></div>
                            </div>
                        </div>
                    </div>
                </div><!--end .card-body -->
            </div><!--end .card -->
        </div><!--end .col -->
        <!-- END ALERT - BOUNCE RATES -->
        <!-- BEGIN ALERT - TIME ON SITE -->
        @*<div class="col-md-3 col-sm-6">
                <div class="card">
                    <div class="card-body no-padding">
                        <div class="alert alert-callout alert-success no-margin">
                            <h1 class="pull-right text-success"><i class="md md-timer"></i></h1>
                            <strong class="text-xl">54 sec.</strong><br />
                            <span class="opacity-50">Avg. time on site</span>
                        </div>
                    </div><!--end .card-body -->
                </div><!--end .card -->
            </div>*@<!--end .col -->
        <!-- END ALERT - TIME ON SITE -->

    @*</div>*@<!--end .row -->


    <div class="row">


    </div><!--end .row -->

    <div>
        @*@{Html.RenderPartial("_CalenderView");}*@
        </ div>
        @*<div class="row">

            <!-- BEGIN ALERT - REVENUE -->
            <div class="col-md-3 col-sm-6">
                <div class="card">
                    <div class="card-body no-padding">
                        <div class="alert alert-callout alert-info no-margin">

                            <strong class="pull-right text-success text-lg">@ViewBag.ActiveStudent %<i class="md md-swap-vert"></i></strong>
                            <strong class="text-xl">@ViewBag.ActiveStudent</strong><br />
                            <span class="opacity-50">Active Students</span>
                            <i class="fa fa-male fa-2x pull-right"></i>
                            <div class="stick-bottom-left-right">
                                <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                            </div>
                        </div>
                    </div><!--end .card-body -->
                </div><!--end .card -->
            </div><!--end .col -->
            <!-- END ALERT - REVENUE -->
            <!-- BEGIN ALERT - VISITS -->
            <div class="col-md-3 col-sm-6">
                <div class="card">
                    <div class="card-body no-padding">
                        <div class="alert alert-callout alert-warning no-margin">
                            <strong class="pull-right text-warning text-lg">@ViewBag.GraduatedStudent % <i class="md md-swap-vert"></i></strong>
                            <strong class="text-xl">@ViewBag.GraduatedStudent</strong><br />
                            <span class="opacity-50">GraduatedStudent</span>
                            <i class="fa fa-female fa-2x pull-right"></i>
                            <div class="stick-bottom-right">
                                <div class="height-1 sparkline-visits" data-bar-color="#e5e6e6"></div>
                            </div>
                        </div>
                    </div><!--end .card-body -->
                </div><!--end .card -->
            </div><!--end .col -->
            <!-- END ALERT - VISITS -->
            <!-- BEGIN ALERT - BOUNCE RATES -->
            @*<div class="col-md-3 col-sm-6">
                <div class="card">
                    <div class="card-body no-padding">
                        <div class="alert alert-callout alert-danger no-margin">
                            <strong class="pull-right text-danger text-lg"> <i class="md md-swap-vert"></i></strong>
                            <strong class="text-xl">@ViewBag.TotalStudent</strong><br />
                            <span class="opacity-50">Total Student</span>
                            <i class="fa fa-male fa-2x pull-right"></i>
                            <i class="fa fa-plus fa-1x pull-right"></i>
                            <i class="fa fa-female fa-2x pull-right"></i>
                            <div class="stick-bottom-left-right">

                            </div>
                        </div>
                    </div><!--end .card-body -->
                </div><!--end .card -->
            </div>*@<!--end .col -->
        <!-- END ALERT - BOUNCE RATES -->
        <!-- BEGIN ALERT - TIME ON SITE -->
        @*<div class="col-md-3 col-sm-6">
                <div class="card">
                    <div class="card-body no-padding">
                        <div class="alert alert-callout alert-success no-margin">
                            <h1 class="pull-right text-success"><i class="md md-timer"></i></h1>
                            <strong class="text-xl">@ViewBag.TotalStaff</strong><br />
                            <span class="opacity-50">Total Staff</span>
                        </div>
                    </div><!--end .card-body -->
                </div><!--end .card -->
            </div>*@<!--end .col -->
        <!-- END ALERT - TIME ON SITE -->

    </div><!--end .row -->
    @*<!-- BEGIN ALERT - VISITS -->
            <div class="col-md-3 col-sm-6">
                <div class="card">
                    <div class="card-body no-padding">
                        <div class="alert alert-callout alert-warning no-margin">
                            <strong class="pull-right text-warning text-lg">0,01% <i class="md md-swap-vert"></i></strong>
                            <strong class="text-xl">432,901</strong><br />
                            <span class="opacity-50">Visits</span>
                            <div class="stick-bottom-right">
                                <div class="height-1 sparkline-visits" data-bar-color="#e5e6e6"></div>
                            </div>
                        </div>
                    </div><!--end .card-body -->
                </div><!--end .card -->
            </div><!--end .col -->
            <!-- END ALERT - VISITS -->
            <!-- BEGIN ALERT - BOUNCE RATES -->
            <div class="col-md-3 col-sm-6">
                <div class="card">
                    <div class="card-body no-padding">
                        <div class="alert alert-callout alert-danger no-margin">
                            <strong class="pull-right text-danger text-lg">0,18% <i class="md md-trending-down"></i></strong>
                            <strong class="text-xl">42.90%</strong><br />
                            <span class="opacity-50">Bounce rate</span>
                            <div class="stick-bottom-left-right">
                                <div class="progress progress-hairline no-margin">
                                    <div class="progress-bar progress-bar-danger" style="width:43%"></div>
                                </div>
                            </div>
                        </div>
                    </div><!--end .card-body -->
                </div><!--end .card -->
            </div><!--end .col -->
            <!-- END ALERT - BOUNCE RATES -->
            <!-- BEGIN ALERT - TIME ON SITE -->
            <div class="col-md-3 col-sm-6">
                <div class="card">
                    <div class="card-body no-padding">
                        <div class="alert alert-callout alert-success no-margin">
                            <h1 class="pull-right text-success"><i class="md md-timer"></i></h1>
                            <strong class="text-xl">54 sec.</strong><br />
                            <span class="opacity-50">Avg. time on site</span>
                        </div>
                    </div><!--end .card-body -->
                </div><!--end .card -->
            </div><!--end .col -->
            <!-- END ALERT - TIME ON SITE -->

        </div><!--end .row -->*@



    <!-- BEGIN TODOS
    <div class="col-md-3">
        <div class="card ">
            <div class="card-head">
                <header>News Titles</header>
                <div class="tools">
                    <a class="btn btn-icon-toggle btn-close"><i class="md md-close"></i></a>
                </div>
            </div>
            @Html.Action("Menu", "Posts")

        </div>
    </div><!--end .col -->
<!-- END TODOS --><!-- BEGIN REGISTRATION HISTORY -->
<div class="col-md-3">
    <div class="card">
        <div class="card-head">
            <header>Latest News Post</header>
            <div class="tools">
                <a class="btn btn-icon-toggle btn-refresh"><i class="md md-refresh"></i></a>
                <a class="btn btn-icon-toggle btn-collapse"><i class="fa fa-angle-down"></i></a>
                <a class="btn btn-icon-toggle btn-close"><i class="md md-close"></i></a>
            </div>
        </div><!--end .card-head -->
        <div class="card-body no-padding ">
            @Html.Action("Menu", "Posts")
        </div>
        </div><!--end .card -->
</div><!--end .col -->
<!-- END REGISTRATION HISTORY -->
        
        
        
        

<!-- BEGIN ALERT - REVENUE -->
    <div class="col-md-3 col-sm-6">
        <div class="card">
            <div class="card-body no-padding">
                <div class="alert alert-callout alert-info no-margin">
                    <strong class="pull-right text-success text-lg"> <i class="md md-trending-up"></i></strong>
                    <strong class="text-xl">


                        @* logic to check if student has been assigned a class *@

                        @*@if(ViewBag.Class == null) { @ViewBag.NotAssinged}
                            else{ @ViewBag.Class}*@

                    </strong><br />
                    <span class="opacity-50">School Fees</span>
                    <div class="stick-bottom-left-right">
                        <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                    </div>
                </div>
            </div><!--end .card-body -->

        </div><!--end .card -->
    </div><!--end .col -->
    <!-- END ALERT - REVENUE -->
    <!-- BEGIN REGISTRATION HISTORY -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-head">
                <header>Subject</header>

            </div><!--end .card-head -->
            <div class="card-body no-padding">
                <div class="row">

                    <div class="col-md-9 hidden-xs">
                        <div class="force-padding text-sm text-default-light">
                            <ul>
                                @foreach (var subjects in Model.Subjects)
                                {
                                    <li>@subjects</li>

                                }

                            </ul>
                        </div>
                    </div>

                </div><!--end .card-body -->
            </div><!--end .card -->
        </div><!--end .col -->
        <!-- END REGISTRATION HISTORY -->


</div><!--end .row -->
        
        
@* school fee analysis *@
<div class="row">
    <div class="col-md-3">
        <div class="card">
            <div class="card-body no-padding">
                <div class="alert alert-callout alert-info no-margin">
                    <strong class="pull-right text-success text-lg"> <i class="md md-trending-up"></i></strong>
                    <strong class="text-xl">


                        @* logic to check if student has been assigned a class *@

                        @*@if(ViewBag.Class == null) { @ViewBag.NotAssinged}
                            else{ @ViewBag.Class}*@

                    </strong><br />
                    <span class="opacity-50">School Fee Analysis</span>
                    <div class="stick-bottom-left-right">
                        <div class="height-2 sparkline-revenue" data-line-color="#bdc1c1"></div>
                    </div>
                </div>
            </div><!--end .card-body -->

        </div><!--end .card -->
    </div>
    <div class="col-md-3">
        
    </div>
    <div class="col-md-6">
        
    </div>

 </div>
        
@* end of school fee analysis *@
        

<!-- BEGIN CALENDAR -->
        <div class="col-sm-4">
            <div class="card">
                <div>
                    <a href="#" id="btnInit" class="btn btn-secondary">Initialise database!</a>
                </div>
                <div class="card-head style-primary">
                    <header>
                        <span class="selected-day">&nbsp;</span> &nbsp;<small class="selected-date">&nbsp;</small>
                    </header>
                    <div class="tools">
                        <div class="btn-group">
                            <a id="calender-prev" class="btn btn-icon-toggle ink-reaction"><i class="fa fa-angle-left"></i></a>
                            <a id="calender-next" class="btn btn-icon-toggle ink-reaction"><i class="fa fa-angle-right"></i></a>
                        </div>
                        <div class="btn-group pull-right">
                        </div>
                    </div>
                    <ul class="nav nav-tabs tabs-text-contrast tabs-accent" data-toggle="tabs">
                        <li data-mode="month" class="active"><a href="#">Month</a></li>
                        <li data-mode="agendaWeek"><a href="#">Week</a></li>
                        <li data-mode="agendaDay"><a href="#">Day</a></li>
                    </ul>
                </div><!--end .card-head -->
                <div class="card-body no-padding">
                    <div id="calendar"></div>
                </div><!--end .card-body -->
            </div><!--end .card -->
        </div><!--end .col -->
        <!-- END CALENDAR -->
        
<div class="row">
    <div class="col-md-6">
    
        @{
            //var listofSchool = Model.Count(x => x.SchoolName.Equals(""));
            var newModel = new DataPoint(Model.FemaleStudents,Model.MaleStudents);

            barModel.Add(newModel);
        }
    </div>
</div>
        

  
  


<div class="row">

        <!-- BEGIN SITE ACTIVITY -->
        <div class="col-md-9">
            <div class="card ">
                <div class="row">
                    <div class="col-sm-9">
                        <div class="card-head">
                            <header>Site activity</header>
                        </div><!--end .card-head -->
                        <div class="card-body height-8">
                            <div id="flot-visitors-legend" class="flot-legend-horizontal stick-top-right no-y-padding"></div>
                            <div id="flot-visitors" class="flot height-7" data-title="Activity entry" data-color="#7dd8d2,#0aa89e"></div>
                        </div><!--end .card-body -->
                    </div><!--end .card-body -->
                    <!-- BEGIN SERVER STATUS -->
                    <div class="col-md-3">
                        <div class="card">
                            <div class="card-head">
                                <header class="text-primary">Server status</header>
                            </div><!--end .card-head -->
                            <div class="card-body height-4">
                                <div class="pull-right text-center">
                                    <em class="text-primary">Temperature</em>
                                    <br/>
                                    <div id="serverStatusKnob" class="knob knob-shadow knob-primary knob-body-track size-2">
                                        <input type="text" class="dial" data-min="0" data-max="100" data-thickness=".09" value="30" data-readOnly=true>
                                    </div>
                                </div>
                            </div><!--end .card-body -->
                            <div class="card-body height-4 no-padding">
                                <div class="stick-bottom-left-right">
                                    <div id="rickshawGraph" class="height-4" data-color1="#0aa89e" data-color2="rgba(79, 89, 89, 0.2)"></div>
                                </div>
                            </div><!--end .card-body -->
                        </div><!--end .card -->
                    </div><!--end .col -->
                    <!-- END SERVER STATUS -->
                </div>
            </div>
        </div>
    </div><!--end .row -->
    <!-- END CONTENT -->
</div>
    @section Scripts {
        @Scripts.Render("~/bundles/jqueryval")

        @*<script>
               // window.alert(5 + 6);
                $(document).ready(function () {

                    var sourceFullView = { url: '/Students/GetDiaryEvents/' };
                    var sourceSummaryView = { url: '/Students/GetDiarySummary/' };
                    var CalLoading = true;

                    $('#calendar').fullCalendar({
                        header: {
                            left: 'prev,next today',
                            center: 'title',
                            right: 'month,agendaWeek,agendaDay'
                        },
                        defaultView: 'agendaDay',
                        editable: true,
                        allDaySlot: false,
                        selectable: true,
                        slotMinutes: 15,
                        events: '/Students/GetDiaryEvents/',
                        eventClick: function (calEvent, jsEvent, view) {
                            alert('You clicked on event id: ' + calEvent.id
                                + "\nSpecial ID: " + calEvent.someKey
                                + "\nAnd the title is: " + calEvent.title);

                        },

                        eventDrop: function (event, dayDelta, minuteDelta, allDay, revertFunc) {
                            if (confirm("Confirm move?")) {
                                UpdateEvent(event.id, event.start);
                            }
                            else {
                                revertFunc();
                            }
                        },

                        eventResize: function (event, dayDelta, minuteDelta, revertFunc) {

                            if (confirm("Confirm change appointment length?")) {
                                UpdateEvent(event.id, event.start, event.end);
                            }
                            else {
                                revertFunc();
                            }
                        },



                        dayClick: function (date, allDay, jsEvent, view) {
                            $('#eventTitle').val("");
                            $('#eventDate').val($.fullCalendar.formatDate(date, 'dd/MM/yyyy'));
                            $('#eventTime').val($.fullCalendar.formatDate(date, 'HH:mm'));
                            ShowEventPopup(date);
                        },

                        viewRender: function (view, element) {

                            if (!CalLoading) {
                                if (view.name == 'month') {
                                    $('#calendar').fullCalendar('removeEventSource', sourceFullView);
                                    $('#calendar').fullCalendar('removeEvents');
                                    $('#calendar').fullCalendar('addEventSource', sourceSummaryView);
                                }
                                else {
                                    $('#calendar').fullCalendar('removeEventSource', sourceSummaryView);
                                    $('#calendar').fullCalendar('removeEvents');
                                    $('#calendar').fullCalendar('addEventSource', sourceFullView);
                                }
                            }
                        }

                    });

                    CalLoading = false;


                });

                $('#btnInit').click(function () {
                    $.ajax({
                        type: 'POST',
                        url: "/Students/Init",
                        success: function (response) {
                            if (response === 'True') {
                                $('#calendar').fullCalendar('refetchEvents');
                                alert('Database populated! ');
                            }
                            else {
                                alert('Error, could not populate database!');
                            }
                        }
                    });
                });

                $('#btnPopupCancel').click(function () {
                    ClearPopupFormValues();
                    $('#popupEventForm').hide();
                });

                $('#btnPopupSave').click(function () {

                    $('#popupEventForm').hide();

                    var dataRow = {
                        'Title': $('#eventTitle').val(),
                        'NewEventDate': $('#eventDate').val(),
                        'NewEventTime': $('#eventTime').val(),
                        'NewEventDuration': $('#eventDuration').val()
                    }

                    ClearPopupFormValues();

                    $.ajax({
                        type: 'POST',
                        url: "/Students/SaveEvent",
                        data: dataRow,
                        success: function (response) {
                            if (response === 'True') {
                                $('#calendar').fullCalendar('refetchEvents');
                                alert('New event saved!');
                            }
                            else {
                                alert('Error, could not save event!');
                            }
                        }
                    });
                });

                function ShowEventPopup(date) {
                    ClearPopupFormValues();
                    $('#popupEventForm').show();
                    $('#eventTitle').focus();
                }

                function ClearPopupFormValues() {
                    $('#eventID').val("");
                    $('#eventTitle').val("");
                    $('#eventDateTime').val("");
                    $('#eventDuration').val("");
                }

                function UpdateEvent(EventID, EventStart, EventEnd) {

                    var dataRow = {
                        'ID': EventID,
                        'NewEventStart': EventStart,
                        'NewEventEnd': EventEnd
                    }

                    $.ajax({    
                        type: 'POST',
                        url: "/Students/UpdateEvent",
                        dataType: "json",
                        contentType: "application/json",
                        data: JSON.stringify(dataRow)
                    });
                }

            </script>*@
    }


